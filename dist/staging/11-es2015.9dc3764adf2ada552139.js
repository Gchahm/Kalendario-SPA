(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{PgJR:function(t,e,n){"use strict";n.r(e);var i=n("PCNd"),c=n("tyNb"),o=n("wd/R"),a=n("eJuo"),s=n("eIep"),r=n("lJxs"),p=n("vyqY"),d=n("YZpF"),u=n("r32Y"),l=n("fXoL"),m=n("kt0X"),b=n("ofXK"),f=n("Nls1"),h=n("3Pt+"),y=n("iadO");let g=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Kb({type:t,selectors:[["app-date-round-button"]],inputs:{active:"active",date:"date"},decls:5,vars:4,consts:[[1,"day-round","c-pointer"],[1,"inner"]],template:function(t,e){1&t&&(l.Wb(0,"p"),l.Gc(1),l.Vb(),l.Wb(2,"div",0),l.Wb(3,"div",1),l.Gc(4),l.Vb(),l.Vb()),2&t&&(l.Db(1),l.Hc(e.date.format("ddd").toUpperCase()),l.Db(1),l.Hb("bg-primary",e.active),l.Db(2),l.Ic(" ",e.date.format("DD")," "))},styles:["[_nghost-%COMP%]{flex:1}.day-round[_ngcontent-%COMP%]{position:relative;margin:auto;width:3rem;height:3rem;border-radius:2rem}.inner[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),t})();var D=n("bTqV");function v(t,e){if(1&t){const t=l.Xb();l.Wb(0,"app-date-round-button",16),l.ec("click",(function(){l.yc(t);const n=e.$implicit;return l.ic().emitDate(n)})),l.Vb()}if(2&t){const t=e.$implicit,n=l.ic();l.oc("active",n.isCurrent(t))("date",t)}}function k(t,e){if(1&t){const t=l.Xb();l.Wb(0,"button",17),l.ec("click",(function(){l.yc(t);const e=l.ic();return e.add.emit(e.currentDate)})),l.Rb(1,"i",18),l.Vb()}}const M=["*"];let C=(()=>{class t{constructor(){this.updateCurrent=new l.o,this.add=new l.o}ngOnInit(){this.timeSpan=this.isMobile?2:3,this.startDate=o().utc().startOf("day").subtract(this.timeSpan,"day"),this.endDate=o().utc().startOf("day").add(this.timeSpan,"day")}dates(){const t=[];let e=o.utc(this.startDate.toISOString());for(;e.isBefore(this.endDate)||e.isSame(this.endDate);)t.push(o.utc(e.toISOString())),e=e.clone().add(1,"day");return t}isCurrent(t){return this.currentDate.format("DDMMYYYY")===t.format("DDMMYYYY")}emitDate(t){this.updateCurrent.emit(t),t.isAfter(this.endDate)&&(this.startDate=t,this.endDate=o.utc(t.toISOString()).add(2*this.timeSpan,"day")),t.isBefore(this.startDate)&&(this.startDate=o.utc(t.toISOString()).subtract(2*this.timeSpan,"day"),this.endDate=t)}nextDay(){this.emitDate(this.currentDate.clone().add(1,"day"))}previousDay(){this.emitDate(this.currentDate.clone().subtract(1,"day"))}availability(){const t=Object(f.c)(this.employee.scheduleModel,this.currentDate);return t.frames.length>0?t.frames.map(t=>t.name).reduce((t,e)=>t+" | "+e):"No Availability"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Kb({type:t,selectors:[["employee-schedule-page-container"]],inputs:{currentDate:"currentDate",appointments:"appointments",permissions:"permissions",employee:"employee",isMobile:"isMobile"},outputs:{updateCurrent:"updateCurrent",add:"add"},ngContentSelectors:M,decls:25,vars:9,consts:[[1,"row"],[1,"col-12","h5","text-center"],[1,"d-flex","c-primary","mx-4","my-2"],[1,"fa","fa-chevron-left","c-pointer",3,"click"],[1,"w-100"],[1,"fa","fa-chevron-right","c-pointer",3,"click"],[1,"d-flex","justify-content-center","h5","text-center"],[3,"active","date","click",4,"ngFor","ngForOf"],[1,"c-pointer",3,"click"],[1,"fa","fa-calendar","mr-2"],[1,"visually-hidden"],[3,"ngModel","matDatepicker","ngModelChange","click"],[3,"touchUi"],["dp",""],[1,"col-12"],["mat-fab","","class","create-button",3,"click",4,"ngIf"],[3,"active","date","click"],["mat-fab","",1,"create-button",3,"click"],[1,"fa","fa-plus"]],template:function(t,e){if(1&t){const t=l.Xb();l.nc(),l.Wb(0,"div",0),l.Wb(1,"div",1),l.Gc(2),l.Vb(),l.Wb(3,"div",1),l.Wb(4,"div",2),l.Wb(5,"i",3),l.ec("click",(function(){return e.previousDay()})),l.Vb(),l.Wb(6,"span",4),l.Gc(7),l.Vb(),l.Wb(8,"i",5),l.ec("click",(function(){return e.nextDay()})),l.Vb(),l.Vb(),l.Wb(9,"div",6),l.Ec(10,v,1,2,"app-date-round-button",7),l.Vb(),l.Rb(11,"hr"),l.Wb(12,"div",8),l.ec("click",(function(){return l.yc(t),l.vc(18).open()})),l.Rb(13,"i",9),l.Gc(14),l.Wb(15,"div",10),l.Wb(16,"input",11),l.ec("ngModelChange",(function(t){return e.emitDate(t)}))("click",(function(){return l.yc(t),l.vc(18).open()})),l.Vb(),l.Vb(),l.Vb(),l.Rb(17,"mat-datepicker",12,13),l.Rb(19,"hr"),l.Gc(20),l.Rb(21,"hr"),l.Vb(),l.Wb(22,"div",14),l.mc(23),l.Vb(),l.Vb(),l.Ec(24,k,2,0,"button",15)}if(2&t){const t=l.vc(18);l.Db(2),l.Ic(" ",e.employee.name," "),l.Db(5),l.Hc(e.currentDate.format("MMMM YYYY")),l.Db(3),l.oc("ngForOf",e.dates()),l.Db(4),l.Ic(" ",e.currentDate.format("dddd, DD MMMM YYYY")," "),l.Db(2),l.oc("ngModel",e.currentDate)("matDatepicker",t),l.Db(1),l.oc("touchUi",e.isMobile),l.Db(3),l.Ic(" ",e.availability()," "),l.Db(4),l.oc("ngIf",e.permissions.add)}},directives:[b.k,h.c,y.d,h.n,h.q,y.c,b.l,g,D.a],styles:["[_nghost-%COMP%]{display:block;position:-webkit-sticky;position:sticky;top:0;left:0;z-index:3;background-color:#fff;height:100%}.create-button[_ngcontent-%COMP%]{position:absolute;bottom:30px;right:10px}"]}),t})();var I=n("Xa2L"),O=n("Qu3c");function V(t,e){if(1&t){const t=l.Xb();l.Wb(0,"p"),l.Wb(1,"i",11),l.ec("click",(function(){return l.yc(t),l.ic().edit()})),l.Vb(),l.Vb()}}let W=(()=>{class t{constructor(t){this.store=t}customerDetails(){return this.appointment.customer.email+"\n"+this.appointment.customer.phone}edit(){this.store.dispatch(p.b.openAppointmentEventDialog({id:this.appointment.id,employeeMode:!0}))}}return t.\u0275fac=function(e){return new(e||t)(l.Qb(m.h))},t.\u0275cmp=l.Kb({type:t,selectors:[["employee-schedule-appointment"]],inputs:{appointment:"appointment",showEdit:"showEdit"},decls:17,vars:7,consts:[[1,"schedule-appointment-container"],[1,"row"],[1,"col-2","text-center","m-auto","c-medium-gray"],[4,"ngIf"],[1,"col-6","m-auto"],[1,"m-auto"],[1,"col-4","c-medium-gray"],[1,"fa","fa-clock","c-primary","mr-2"],[1,"c-primary",3,"matTooltip","matTooltipClass"],[1,"fa","fa-address-card","mr-2"],[1,"col-12"],[1,"fa","fa-pen","c-primary","c-pointer",3,"click"]],template:function(t,e){1&t&&(l.Wb(0,"div",0),l.Wb(1,"div",1),l.Wb(2,"div",2),l.Gc(3),l.Ec(4,V,2,0,"p",3),l.Vb(),l.Wb(5,"div",4),l.Wb(6,"p",5),l.Gc(7),l.Vb(),l.Vb(),l.Wb(8,"div",6),l.Wb(9,"p"),l.Rb(10,"i",7),l.Gc(11),l.Vb(),l.Wb(12,"p",8),l.Rb(13,"i",9),l.Gc(14),l.Vb(),l.Vb(),l.Wb(15,"div",10),l.Rb(16,"hr"),l.Vb(),l.Vb(),l.Vb()),2&t&&(l.Db(3),l.Ic(" ",e.appointment.start.format("HH:mm")," "),l.Db(1),l.oc("ngIf",e.showEdit),l.Db(3),l.Ic(" ",e.appointment.service.name," "),l.Db(4),l.Ic(" ",e.appointment.service.duration," "),l.Db(1),l.oc("matTooltip",e.customerDetails())("matTooltipClass","tooltip-ws"),l.Db(2),l.Ic("",e.appointment.customer.name," "))},directives:[b.l,O.a],styles:[".schedule-appointment-container[_ngcontent-%COMP%]{font-weight:600;margin:0 15px}p[_ngcontent-%COMP%]{margin:0}"]}),t})();function w(t,e){1&t&&l.Sb(0)}function E(t,e){if(1&t&&(l.Wb(0,"div",2),l.Wb(1,"div",3),l.Ec(2,w,1,0,"ng-container",4),l.Vb(),l.Vb()),2&t){l.ic();const t=l.vc(3);l.Db(2),l.oc("ngTemplateOutlet",t)}}function x(t,e){1&t&&(l.Wb(0,"div",9),l.Rb(1,"mat-spinner"),l.Vb())}function j(t,e){if(1&t&&(l.Rb(0,"employee-schedule-appointment",11),l.jc(1,"async")),2&t){const t=e.$implicit,n=l.ic(4);l.oc("appointment",t)("showEdit",l.kc(1,2,n.permissions$).change)}}function Y(t,e){if(1&t&&(l.Ec(0,j,2,4,"employee-schedule-appointment",10),l.jc(1,"async")),2&t){const t=l.ic(3);l.oc("ngForOf",l.kc(1,1,t.appointments$))}}function $(t,e){if(1&t){const t=l.Xb();l.Wb(0,"employee-schedule-page-container",6),l.ec("updateCurrent",(function(e){return l.yc(t),l.ic(2).updateCurrent(e)}))("add",(function(n){l.yc(t);const i=e.ngIf;return l.ic(2).openCreateDialog(n,i)})),l.jc(1,"async"),l.jc(2,"async"),l.jc(3,"async"),l.jc(4,"async"),l.Ec(5,x,2,0,"div",7),l.jc(6,"async"),l.Ec(7,Y,2,3,"ng-template",null,8,l.Fc),l.Vb()}if(2&t){const t=e.ngIf,n=l.vc(8),i=l.ic(2);l.oc("currentDate",l.kc(1,7,i.currentDate$))("appointments",l.kc(2,9,i.appointments$))("permissions",l.kc(3,11,i.permissions$))("employee",t)("isMobile",l.kc(4,13,i.isMobile$)),l.Db(5),l.oc("ngIf",l.kc(6,15,i.isLoading$))("ngIfElse",n)}}function S(t,e){if(1&t&&(l.Ec(0,$,9,17,"employee-schedule-page-container",5),l.jc(1,"async")),2&t){const t=l.ic();l.oc("ngIf",l.kc(1,1,t.employee$))}}const P=[{path:"",icon:"",component:(()=>{class t extends u.a{constructor(t){super(t)}ngOnInit(){this.initialize(),this.employee$=this.store.select(d.B),this.appointments$=this.employee$.pipe(Object(s.a)(t=>this.store.select(p.d.selectCurrentDateEmployeeAppointments,{employeeId:t.id}))),this.permissions$=this.store.select(d.z,{model:a.a.modelType}),this.currentDate$=this.store.select(p.d.selectCurrentDate).pipe(Object(r.a)(t=>o.utc(t))),this.isLoading$=this.store.select(p.d.getIsLoadingEntities)}initialize(){const t=o().utc().startOf("day");this.updateCurrent(t),this.loadAppointments(t)}updateCurrent(t){this.store.dispatch(p.b.setCurrentDate({date:t})),this.loadAppointments(t)}loadAppointments(t){const e={fromDate:o.utc(t).startOf("day"),toDate:o.utc(t).endOf("day")};this.store.dispatch(p.b.requestEntities({params:e}))}openCreateDialog(t,e){this.store.dispatch(p.b.openCreateAppointmentDialog({date:t,employee:e,employeeMode:!0}))}}return t.\u0275fac=function(e){return new(e||t)(l.Qb(m.h))},t.\u0275cmp=l.Kb({type:t,selectors:[["employee-schedule-page"]],features:[l.Ab],decls:4,vars:4,consts:[["class","d-flex justify-content-center h-100",4,"ngIf","ngIfElse"],["schedule",""],[1,"d-flex","justify-content-center","h-100"],[1,"card-400","company-shadow-1","m-auto"],[4,"ngTemplateOutlet"],[3,"currentDate","appointments","permissions","employee","isMobile","updateCurrent","add",4,"ngIf"],[3,"currentDate","appointments","permissions","employee","isMobile","updateCurrent","add"],["class","d-flex justify-content-center",4,"ngIf","ngIfElse"],["appointments",""],[1,"d-flex","justify-content-center"],[3,"appointment","showEdit",4,"ngFor","ngForOf"],[3,"appointment","showEdit"]],template:function(t,e){if(1&t&&(l.Ec(0,E,3,1,"div",0),l.jc(1,"async"),l.Ec(2,S,2,3,"ng-template",null,1,l.Fc)),2&t){const t=l.vc(3);l.oc("ngIf",!l.kc(1,2,e.isMobile$))("ngIfElse",t)}},directives:[b.l,b.q,C,I.b,b.k,W],pipes:[b.b],styles:["[_nghost-%COMP%]{display:block;height:calc(100vh - 65px);min-height:calc(100vh - 65px)}.card-400[_ngcontent-%COMP%]{height:90%;border-radius:10px;padding:10px}"],changeDetection:0}),t})(),canActivate:[(()=>{class t{constructor(t){this.store=t}canActivate(t,e){return this.store.pipe(d.p,Object(r.a)(t=>!!t.employee))}}return t.\u0275fac=function(e){return new(e||t)(l.ac(m.h))},t.\u0275prov=l.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()]}];let R=(()=>{class t{}return t.\u0275mod=l.Ob({type:t}),t.\u0275inj=l.Nb({factory:function(e){return new(e||t)},imports:[[c.f.forChild(P)],c.f]}),t})();var A=n("QiP+");n.d(e,"EmployeeModule",(function(){return G}));let G=(()=>{class t{}return t.\u0275mod=l.Ob({type:t}),t.\u0275inj=l.Nb({factory:function(e){return new(e||t)},imports:[[i.a,R,A.a]]}),t})()}}]);