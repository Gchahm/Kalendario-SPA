(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{PgJR:function(t,e,n){"use strict";n.r(e);var i=n("PCNd"),c=n("tyNb"),o=n("wd/R"),a=n("eJuo"),s=n("eIep"),r=n("lJxs"),p=n("vyqY"),l=n("YZpF"),d=n("r32Y"),u=n("fXoL"),f=n("kt0X"),m=n("ofXK"),b=n("Nls1"),h=n("3Pt+"),y=n("iadO");let g=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Kb({type:t,selectors:[["app-date-round-button"]],inputs:{active:"active",date:"date"},decls:5,vars:4,consts:[[1,"day-round","c-pointer"],[1,"inner"]],template:function(t,e){1&t&&(u.Wb(0,"p"),u.Gc(1),u.Vb(),u.Wb(2,"div",0),u.Wb(3,"div",1),u.Gc(4),u.Vb(),u.Vb()),2&t&&(u.Db(1),u.Hc(e.date.format("ddd").toUpperCase()),u.Db(1),u.Hb("bg-primary",e.active),u.Db(2),u.Ic(" ",e.date.format("DD")," "))},styles:["[_nghost-%COMP%]{flex:1}.day-round[_ngcontent-%COMP%]{position:relative;margin:auto;width:3rem;height:3rem;border-radius:2rem}.inner[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),t})();var D=n("bTqV");function v(t,e){if(1&t){const t=u.Xb();u.Wb(0,"app-date-round-button",13),u.ec("click",(function(){u.yc(t);const n=e.$implicit;return u.ic().emitDate(n)})),u.Vb()}if(2&t){const t=e.$implicit,n=u.ic();u.oc("active",n.isCurrent(t))("date",t)}}function M(t,e){if(1&t){const t=u.Xb();u.Wb(0,"button",14),u.ec("click",(function(){u.yc(t);const e=u.ic();return e.add.emit(e.currentDate)})),u.Rb(1,"i",15),u.Vb()}}const k=["*"];let I=(()=>{class t{constructor(){this.updateCurrent=new u.o,this.add=new u.o}ngOnInit(){this.timeSpan=this.isMobile?2:3,this.startDate=o().utc().startOf("day").subtract(this.timeSpan,"day"),this.endDate=o().utc().startOf("day").add(this.timeSpan,"day")}dates(){const t=[];let e=o.utc(this.startDate.toISOString());for(;e.isBefore(this.endDate)||e.isSame(this.endDate);)t.push(o.utc(e.toISOString())),e=e.clone().add(1,"day");return t}isCurrent(t){return this.currentDate.format("DDMMYYYY")===t.format("DDMMYYYY")}emitDate(t){this.updateCurrent.emit(t),t.isAfter(this.endDate)&&(this.startDate=t,this.endDate=o.utc(t.toISOString()).add(2*this.timeSpan,"day")),t.isBefore(this.startDate)&&(this.startDate=o.utc(t.toISOString()).subtract(2*this.timeSpan,"day"),this.endDate=t)}nextDay(){this.emitDate(this.currentDate.clone().add(1,"day"))}previousDay(){this.emitDate(this.currentDate.clone().subtract(1,"day"))}availability(){var t;const e=Object(b.c)(this.employee.scheduleModel,this.currentDate);return(null===(t=e)||void 0===t?void 0:t.frames.length)>0?e.frames.map(t=>t.name).reduce((t,e)=>t+" | "+e):"No Availability"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=u.Kb({type:t,selectors:[["employee-schedule-page-container"]],inputs:{currentDate:"currentDate",appointments:"appointments",permissions:"permissions",employee:"employee",isMobile:"isMobile"},outputs:{updateCurrent:"updateCurrent",add:"add"},ngContentSelectors:k,decls:26,vars:9,consts:[[1,"d-flex","justify-content-around","c-primary","h5"],[1,"fa","fa-chevron-left","c-pointer",3,"click"],[1,"fa","fa-chevron-right","c-pointer",3,"click"],[1,"d-flex","justify-content-center"],[3,"active","date","click",4,"ngFor","ngForOf"],[1,"c-pointer",3,"click"],[1,"fa","fa-calendar","mr-2"],[1,"visually-hidden"],[3,"ngModel","matDatepicker","ngModelChange","click"],[3,"touchUi"],["dp",""],[1,"flex-fill","pretty-scroll"],["mat-fab","","class","create-button",3,"click",4,"ngIf"],[3,"active","date","click"],["mat-fab","",1,"create-button",3,"click"],[1,"fa","fa-plus"]],template:function(t,e){if(1&t){const t=u.Xb();u.nc(),u.Wb(0,"h5"),u.Gc(1),u.Vb(),u.Wb(2,"div",0),u.Wb(3,"i",1),u.ec("click",(function(){return e.previousDay()})),u.Vb(),u.Wb(4,"span"),u.Gc(5),u.Vb(),u.Wb(6,"i",2),u.ec("click",(function(){return e.nextDay()})),u.Vb(),u.Vb(),u.Wb(7,"div",3),u.Ec(8,v,1,2,"app-date-round-button",4),u.Vb(),u.Wb(9,"div"),u.Rb(10,"hr"),u.Vb(),u.Wb(11,"div",5),u.ec("click",(function(){return u.yc(t),u.vc(17).open()})),u.Rb(12,"i",6),u.Gc(13),u.Wb(14,"div",7),u.Wb(15,"input",8),u.ec("ngModelChange",(function(t){return e.emitDate(t)}))("click",(function(){return u.yc(t),u.vc(17).open()})),u.Vb(),u.Vb(),u.Vb(),u.Rb(16,"mat-datepicker",9,10),u.Wb(18,"div"),u.Rb(19,"hr"),u.Vb(),u.Gc(20),u.Wb(21,"div"),u.Rb(22,"hr"),u.Vb(),u.Wb(23,"div",11),u.mc(24),u.Vb(),u.Ec(25,M,2,0,"button",12)}if(2&t){const t=u.vc(17);u.Db(1),u.Ic(" ",e.employee.name,"\n"),u.Db(4),u.Hc(e.currentDate.format("MMMM YYYY")),u.Db(3),u.oc("ngForOf",e.dates()),u.Db(5),u.Ic(" ",e.currentDate.format("dddd, DD MMMM YYYY")," "),u.Db(2),u.oc("ngModel",e.currentDate)("matDatepicker",t),u.Db(1),u.oc("touchUi",e.isMobile),u.Db(4),u.Ic(" ",e.availability()," "),u.Db(5),u.oc("ngIf",e.permissions.add)}},directives:[m.k,h.c,y.d,h.n,h.q,y.c,m.l,g,D.a],styles:["[_nghost-%COMP%]{padding:1rem;display:flex;flex-direction:column;text-align:center;position:sticky;top:0;left:0;z-index:3;background-color:#fff;height:100%;max-height:100%}.create-button[_ngcontent-%COMP%]{position:absolute;bottom:30px;right:10px}.pretty-scroll[_ngcontent-%COMP%]{overflow:scroll}"]}),t})();var x=n("Xa2L");function V(t,e){if(1&t&&(u.Wb(0,"p"),u.Rb(1,"i",8),u.Gc(2),u.Vb()),2&t){const t=u.ic(2);u.Db(2),u.Ic(" ",t.appointment.internalNotes," ")}}function C(t,e){if(1&t&&(u.Wb(0,"p"),u.Rb(1,"i",9),u.Gc(2),u.Vb()),2&t){const t=u.ic(2);u.Db(2),u.Ic(" ",t.appointment.customerNotes," ")}}function O(t,e){if(1&t&&(u.Wb(0,"div",4),u.Gc(1),u.Wb(2,"div"),u.Rb(3,"i",5),u.Gc(4),u.Vb(),u.Wb(5,"div"),u.Rb(6,"i",6),u.Gc(7),u.Vb(),u.Wb(8,"div"),u.Ec(9,V,3,1,"p",7),u.Ec(10,C,3,1,"p",7),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Db(1),u.Ic(" ",t.appointment.service.name," "),u.Db(3),u.Jc(" ",t.appointment.start.format("HH:mm")," - ",t.appointment.end.format("HH:mm")," "),u.Db(3),u.Ic(" ",null==t.appointment.customer?null:t.appointment.customer.name," "),u.Db(2),u.oc("ngIf",t.appointment.internalNotes),u.Db(1),u.oc("ngIf",t.appointment.customerNotes)}}function W(t,e){if(1&t&&(u.Wb(0,"div",10),u.Wb(1,"p"),u.Gc(2),u.Vb(),u.Vb()),2&t){const t=u.ic();u.Db(2),u.Jc("Locked time ",t.appointment.start.format("HH:MM")," - ",t.appointment.end.format("HH:MM")," ")}}function E(t,e){if(1&t){const t=u.Xb();u.Wb(0,"i",11),u.ec("click",(function(){return u.yc(t),u.ic().edit()})),u.Vb()}}let w=(()=>{class t{constructor(t){this.store=t}customerDetails(){var t,e;return(null===(t=this.appointment.customer)||void 0===t?void 0:t.email)+"\n"+(null===(e=this.appointment.customer)||void 0===e?void 0:e.phone)}edit(){this.store.dispatch(p.b.openAppointmentEventDialog({id:this.appointment.id,employeeMode:!0}))}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(f.h))},t.\u0275cmp=u.Kb({type:t,selectors:[["employee-schedule-appointment"]],inputs:{appointment:"appointment",showEdit:"showEdit"},decls:7,vars:3,consts:[[1,"d-flex","align-items-end","justify-content-around"],["class","d-flex flex-column flex-fill text-left",4,"ngIf"],["class","flex-fill",4,"ngIf"],["class","fa fa-pen c-primary c-pointer mr-4",3,"click",4,"ngIf"],[1,"d-flex","flex-column","flex-fill","text-left"],[1,"fa","fa-clock","c-primary","mr-2"],[1,"fa","fa-address-card","mr-2","c-primary"],[4,"ngIf"],[1,"fa","fa-sticky-note","c-primary","mr-2"],[1,"fa","fa-comment-alt","c-primary","mr-2"],[1,"flex-fill"],[1,"fa","fa-pen","c-primary","c-pointer","mr-4",3,"click"]],template:function(t,e){1&t&&(u.Wb(0,"div",0),u.Ec(1,O,11,6,"div",1),u.Ec(2,W,3,2,"div",2),u.Wb(3,"div"),u.Ec(4,E,1,0,"i",3),u.Vb(),u.Vb(),u.Wb(5,"div"),u.Rb(6,"hr"),u.Vb()),2&t&&(u.Db(1),u.oc("ngIf",e.appointment.customer),u.Db(1),u.oc("ngIf",!e.appointment.customer),u.Db(2),u.oc("ngIf",e.showEdit))},directives:[m.l],styles:["[_nghost-%COMP%]{font-weight:600;margin:0 15px;display:flex;flex-direction:column}p[_ngcontent-%COMP%]{margin:0}"]}),t})();function j(t,e){1&t&&u.Sb(0)}function Y(t,e){if(1&t&&(u.Wb(0,"div",2),u.Wb(1,"div",3),u.Ec(2,j,1,0,"ng-container",4),u.Vb(),u.Vb()),2&t){u.ic();const t=u.vc(3);u.Db(2),u.oc("ngTemplateOutlet",t)}}function $(t,e){1&t&&(u.Wb(0,"div",9),u.Rb(1,"mat-spinner"),u.Vb())}function S(t,e){if(1&t&&(u.Rb(0,"employee-schedule-appointment",11),u.jc(1,"async")),2&t){const t=e.$implicit,n=u.ic(4);u.oc("appointment",t)("showEdit",u.kc(1,2,n.permissions$).change)}}function R(t,e){if(1&t&&(u.Ec(0,S,2,4,"employee-schedule-appointment",10),u.jc(1,"async")),2&t){const t=u.ic(3);u.oc("ngForOf",u.kc(1,1,t.appointments$))}}function P(t,e){if(1&t){const t=u.Xb();u.Wb(0,"employee-schedule-page-container",6),u.ec("updateCurrent",(function(e){return u.yc(t),u.ic(2).updateCurrent(e)}))("add",(function(n){u.yc(t);const i=e.ngIf;return u.ic(2).openCreateDialog(n,i)})),u.jc(1,"async"),u.jc(2,"async"),u.jc(3,"async"),u.jc(4,"async"),u.Ec(5,$,2,0,"div",7),u.jc(6,"async"),u.Ec(7,R,2,3,"ng-template",null,8,u.Fc),u.Vb()}if(2&t){const t=e.ngIf,n=u.vc(8),i=u.ic(2);u.oc("currentDate",u.kc(1,7,i.currentDate$))("appointments",u.kc(2,9,i.appointments$))("permissions",u.kc(3,11,i.permissions$))("employee",t)("isMobile",u.kc(4,13,i.isMobile$)),u.Db(5),u.oc("ngIf",u.kc(6,15,i.isLoading$))("ngIfElse",n)}}function G(t,e){if(1&t&&(u.Ec(0,P,9,17,"employee-schedule-page-container",5),u.jc(1,"async")),2&t){const t=u.ic();u.oc("ngIf",u.kc(1,1,t.employee$))}}const A=[{path:"",icon:"",component:(()=>{class t extends d.a{constructor(t){super(t)}ngOnInit(){this.initialize(),this.employee$=this.store.select(l.B),this.appointments$=this.employee$.pipe(Object(s.a)(t=>this.store.select(p.d.selectCurrentDateEmployeeAppointments,{employeeId:t.id}))),this.permissions$=this.store.select(l.z,{model:a.a.modelType}),this.currentDate$=this.store.select(p.d.selectCurrentDate).pipe(Object(r.a)(t=>o.utc(t))),this.isLoading$=this.store.select(p.d.getIsLoadingEntities)}initialize(){const t=o().utc().startOf("day");this.updateCurrent(t),this.loadAppointments(t)}updateCurrent(t){this.store.dispatch(p.b.setCurrentDate({date:t})),this.loadAppointments(t)}loadAppointments(t){const e={fromDate:o.utc(t).startOf("day"),toDate:o.utc(t).endOf("day")};this.store.dispatch(p.b.requestEntities({params:e}))}openCreateDialog(t,e){this.store.dispatch(p.b.openCreateAppointmentDialog({date:t,employee:e,employeeMode:!0}))}}return t.\u0275fac=function(e){return new(e||t)(u.Qb(f.h))},t.\u0275cmp=u.Kb({type:t,selectors:[["employee-schedule-page"]],features:[u.Ab],decls:4,vars:4,consts:[["class","d-flex justify-content-center h-100",4,"ngIf","ngIfElse"],["schedule",""],[1,"d-flex","justify-content-center","h-100"],[1,"card-400","company-shadow-1","m-auto"],[4,"ngTemplateOutlet"],[3,"currentDate","appointments","permissions","employee","isMobile","updateCurrent","add",4,"ngIf"],[3,"currentDate","appointments","permissions","employee","isMobile","updateCurrent","add"],["class","d-flex justify-content-center",4,"ngIf","ngIfElse"],["appointments",""],[1,"d-flex","justify-content-center"],[3,"appointment","showEdit",4,"ngFor","ngForOf"],[3,"appointment","showEdit"]],template:function(t,e){if(1&t&&(u.Ec(0,Y,3,1,"div",0),u.jc(1,"async"),u.Ec(2,G,2,3,"ng-template",null,1,u.Fc)),2&t){const t=u.vc(3);u.oc("ngIf",!u.kc(1,2,e.isMobile$))("ngIfElse",t)}},directives:[m.l,m.q,I,x.b,m.k,w],pipes:[m.b],styles:["[_nghost-%COMP%]{display:block;height:calc(100vh - 65px);min-height:calc(100vh - 65px)}.card-400[_ngcontent-%COMP%]{height:90%;border-radius:10px;padding:10px}"],changeDetection:0}),t})(),canActivate:[(()=>{class t{constructor(t){this.store=t}canActivate(t,e){return this.store.pipe(l.p,Object(r.a)(t=>!!t.employee))}}return t.\u0275fac=function(e){return new(e||t)(u.ac(f.h))},t.\u0275prov=u.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()]}];let H=(()=>{class t{}return t.\u0275mod=u.Ob({type:t}),t.\u0275inj=u.Nb({factory:function(e){return new(e||t)},imports:[[c.f.forChild(A)],c.f]}),t})();var N=n("QiP+");n.d(e,"EmployeeModule",(function(){return _}));let _=(()=>{class t{}return t.\u0275mod=u.Ob({type:t}),t.\u0275inj=u.Nb({factory:function(e){return new(e||t)},imports:[[i.a,H,N.a]]}),t})()}}]);