function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(t);if(e){var c=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,c)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{PgJR:function(t,e,n){"use strict";n.r(e);var i,c=n("PCNd"),o=n("tyNb"),r=n("wd/R"),a=n("eJuo"),s=n("eIep"),u=n("lJxs"),l=n("vyqY"),p=n("YZpF"),f=n("r32Y"),d=n("fXoL"),b=n("kt0X"),m=n("ofXK"),h=n("Nls1"),y=n("3Pt+"),v=n("iadO"),g=((i=function t(){_classCallCheck(this,t)}).\u0275fac=function(t){return new(t||i)},i.\u0275cmp=d.Kb({type:i,selectors:[["app-date-round-button"]],inputs:{active:"active",date:"date"},decls:5,vars:4,consts:[[1,"day-round","c-pointer"],[1,"inner"]],template:function(t,e){1&t&&(d.Wb(0,"p"),d.Gc(1),d.Vb(),d.Wb(2,"div",0),d.Wb(3,"div",1),d.Gc(4),d.Vb(),d.Vb()),2&t&&(d.Db(1),d.Hc(e.date.format("ddd").toUpperCase()),d.Db(1),d.Hb("bg-primary",e.active),d.Db(2),d.Ic(" ",e.date.format("DD")," "))},styles:["[_nghost-%COMP%]{flex:1}.day-round[_ngcontent-%COMP%]{position:relative;margin:auto;width:3rem;height:3rem;border-radius:2rem}.inner[_ngcontent-%COMP%]{margin:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}"]}),i),D=n("bTqV");function k(t,e){if(1&t){var n=d.Xb();d.Wb(0,"app-date-round-button",13),d.ec("click",(function(){d.yc(n);var t=e.$implicit;return d.ic().emitDate(t)})),d.Vb()}if(2&t){var i=e.$implicit,c=d.ic();d.oc("active",c.isCurrent(i))("date",i)}}function C(t,e){if(1&t){var n=d.Xb();d.Wb(0,"button",14),d.ec("click",(function(){d.yc(n);var t=d.ic();return t.add.emit(t.currentDate)})),d.Rb(1,"i",15),d.Vb()}}var O,_=["*"],M=((O=function(){function t(){_classCallCheck(this,t),this.updateCurrent=new d.o,this.add=new d.o}return _createClass(t,[{key:"ngOnInit",value:function(){this.timeSpan=this.isMobile?2:3,this.startDate=r().utc().startOf("day").subtract(this.timeSpan,"day"),this.endDate=r().utc().startOf("day").add(this.timeSpan,"day")}},{key:"dates",value:function(){for(var t=[],e=r.utc(this.startDate.toISOString());e.isBefore(this.endDate)||e.isSame(this.endDate);)t.push(r.utc(e.toISOString())),e=e.clone().add(1,"day");return t}},{key:"isCurrent",value:function(t){return this.currentDate.format("DDMMYYYY")===t.format("DDMMYYYY")}},{key:"emitDate",value:function(t){this.updateCurrent.emit(t),t.isAfter(this.endDate)&&(this.startDate=t,this.endDate=r.utc(t.toISOString()).add(2*this.timeSpan,"day")),t.isBefore(this.startDate)&&(this.startDate=r.utc(t.toISOString()).subtract(2*this.timeSpan,"day"),this.endDate=t)}},{key:"nextDay",value:function(){this.emitDate(this.currentDate.clone().add(1,"day"))}},{key:"previousDay",value:function(){this.emitDate(this.currentDate.clone().subtract(1,"day"))}},{key:"availability",value:function(){var t,e=Object(h.c)(this.employee.scheduleModel,this.currentDate);return(null===(t=e)||void 0===t?void 0:t.frames.length)>0?e.frames.map((function(t){return t.name})).reduce((function(t,e){return t+" | "+e})):"No Availability"}}]),t}()).\u0275fac=function(t){return new(t||O)},O.\u0275cmp=d.Kb({type:O,selectors:[["employee-schedule-page-container"]],inputs:{currentDate:"currentDate",appointments:"appointments",permissions:"permissions",employee:"employee",isMobile:"isMobile"},outputs:{updateCurrent:"updateCurrent",add:"add"},ngContentSelectors:_,decls:26,vars:9,consts:[[1,"d-flex","justify-content-around","c-primary","h5"],[1,"fa","fa-chevron-left","c-pointer",3,"click"],[1,"fa","fa-chevron-right","c-pointer",3,"click"],[1,"d-flex","justify-content-center"],[3,"active","date","click",4,"ngFor","ngForOf"],[1,"c-pointer",3,"click"],[1,"fa","fa-calendar","mr-2"],[1,"visually-hidden"],[3,"ngModel","matDatepicker","ngModelChange","click"],[3,"touchUi"],["dp",""],[1,"flex-fill","pretty-scroll"],["mat-fab","","class","create-button",3,"click",4,"ngIf"],[3,"active","date","click"],["mat-fab","",1,"create-button",3,"click"],[1,"fa","fa-plus"]],template:function(t,e){if(1&t){var n=d.Xb();d.nc(),d.Wb(0,"h5"),d.Gc(1),d.Vb(),d.Wb(2,"div",0),d.Wb(3,"i",1),d.ec("click",(function(){return e.previousDay()})),d.Vb(),d.Wb(4,"span"),d.Gc(5),d.Vb(),d.Wb(6,"i",2),d.ec("click",(function(){return e.nextDay()})),d.Vb(),d.Vb(),d.Wb(7,"div",3),d.Ec(8,k,1,2,"app-date-round-button",4),d.Vb(),d.Wb(9,"div"),d.Rb(10,"hr"),d.Vb(),d.Wb(11,"div",5),d.ec("click",(function(){return d.yc(n),d.vc(17).open()})),d.Rb(12,"i",6),d.Gc(13),d.Wb(14,"div",7),d.Wb(15,"input",8),d.ec("ngModelChange",(function(t){return e.emitDate(t)}))("click",(function(){return d.yc(n),d.vc(17).open()})),d.Vb(),d.Vb(),d.Vb(),d.Rb(16,"mat-datepicker",9,10),d.Wb(18,"div"),d.Rb(19,"hr"),d.Vb(),d.Gc(20),d.Wb(21,"div"),d.Rb(22,"hr"),d.Vb(),d.Wb(23,"div",11),d.mc(24),d.Vb(),d.Ec(25,C,2,0,"button",12)}if(2&t){var i=d.vc(17);d.Db(1),d.Ic(" ",e.employee.name,"\n"),d.Db(4),d.Hc(e.currentDate.format("MMMM YYYY")),d.Db(3),d.oc("ngForOf",e.dates()),d.Db(5),d.Ic(" ",e.currentDate.format("dddd, DD MMMM YYYY")," "),d.Db(2),d.oc("ngModel",e.currentDate)("matDatepicker",i),d.Db(1),d.oc("touchUi",e.isMobile),d.Db(4),d.Ic(" ",e.availability()," "),d.Db(5),d.oc("ngIf",e.permissions.add)}},directives:[m.k,y.c,v.d,y.n,y.q,v.c,m.l,g,D.a],styles:["[_nghost-%COMP%]{padding:1rem;display:flex;flex-direction:column;text-align:center;position:sticky;top:0;left:0;z-index:3;background-color:#fff;height:100%;max-height:100%}.create-button[_ngcontent-%COMP%]{position:absolute;bottom:30px;right:10px}.pretty-scroll[_ngcontent-%COMP%]{overflow:scroll}"]}),O),I=n("Xa2L");function x(t,e){if(1&t&&(d.Wb(0,"p"),d.Rb(1,"i",8),d.Gc(2),d.Vb()),2&t){var n=d.ic(2);d.Db(2),d.Ic(" ",n.appointment.internalNotes," ")}}function V(t,e){if(1&t&&(d.Wb(0,"p"),d.Rb(1,"i",9),d.Gc(2),d.Vb()),2&t){var n=d.ic(2);d.Db(2),d.Ic(" ",n.appointment.customerNotes," ")}}function w(t,e){if(1&t&&(d.Wb(0,"div",4),d.Gc(1),d.Wb(2,"div"),d.Rb(3,"i",5),d.Gc(4),d.Vb(),d.Wb(5,"div"),d.Rb(6,"i",6),d.Gc(7),d.Vb(),d.Wb(8,"div"),d.Ec(9,x,3,1,"p",7),d.Ec(10,V,3,1,"p",7),d.Vb(),d.Vb()),2&t){var n=d.ic();d.Db(1),d.Ic(" ",n.appointment.service.name," "),d.Db(3),d.Jc(" ",n.appointment.start.format("HH:mm")," - ",n.appointment.end.format("HH:mm")," "),d.Db(3),d.Ic(" ",null==n.appointment.customer?null:n.appointment.customer.name," "),d.Db(2),d.oc("ngIf",n.appointment.internalNotes),d.Db(1),d.oc("ngIf",n.appointment.customerNotes)}}function W(t,e){if(1&t&&(d.Wb(0,"div",10),d.Wb(1,"p"),d.Gc(2),d.Vb(),d.Vb()),2&t){var n=d.ic();d.Db(2),d.Jc("Locked time ",n.appointment.start.format("HH:MM")," - ",n.appointment.end.format("HH:MM")," ")}}function E(t,e){if(1&t){var n=d.Xb();d.Wb(0,"i",11),d.ec("click",(function(){return d.yc(n),d.ic().edit()})),d.Vb()}}var P,j=((P=function(){function t(e){_classCallCheck(this,t),this.store=e}return _createClass(t,[{key:"customerDetails",value:function(){var t,e;return(null===(t=this.appointment.customer)||void 0===t?void 0:t.email)+"\n"+(null===(e=this.appointment.customer)||void 0===e?void 0:e.phone)}},{key:"edit",value:function(){this.store.dispatch(l.b.openAppointmentEventDialog({id:this.appointment.id,employeeMode:!0}))}}]),t}()).\u0275fac=function(t){return new(t||P)(d.Qb(b.h))},P.\u0275cmp=d.Kb({type:P,selectors:[["employee-schedule-appointment"]],inputs:{appointment:"appointment",showEdit:"showEdit"},decls:7,vars:3,consts:[[1,"d-flex","align-items-end","justify-content-around"],["class","d-flex flex-column flex-fill text-left",4,"ngIf"],["class","flex-fill",4,"ngIf"],["class","fa fa-pen c-primary c-pointer mr-4",3,"click",4,"ngIf"],[1,"d-flex","flex-column","flex-fill","text-left"],[1,"fa","fa-clock","c-primary","mr-2"],[1,"fa","fa-address-card","mr-2","c-primary"],[4,"ngIf"],[1,"fa","fa-sticky-note","c-primary","mr-2"],[1,"fa","fa-comment-alt","c-primary","mr-2"],[1,"flex-fill"],[1,"fa","fa-pen","c-primary","c-pointer","mr-4",3,"click"]],template:function(t,e){1&t&&(d.Wb(0,"div",0),d.Ec(1,w,11,6,"div",1),d.Ec(2,W,3,2,"div",2),d.Wb(3,"div"),d.Ec(4,E,1,0,"i",3),d.Vb(),d.Vb(),d.Wb(5,"div"),d.Rb(6,"hr"),d.Vb()),2&t&&(d.Db(1),d.oc("ngIf",e.appointment.customer),d.Db(1),d.oc("ngIf",!e.appointment.customer),d.Db(2),d.oc("ngIf",e.showEdit))},directives:[m.l],styles:["[_nghost-%COMP%]{font-weight:600;margin:0 15px;display:flex;flex-direction:column}p[_ngcontent-%COMP%]{margin:0}"]}),P);function R(t,e){1&t&&d.Sb(0)}function S(t,e){if(1&t&&(d.Wb(0,"div",2),d.Wb(1,"div",3),d.Ec(2,R,1,0,"ng-container",4),d.Vb(),d.Vb()),2&t){d.ic();var n=d.vc(3);d.Db(2),d.oc("ngTemplateOutlet",n)}}function Y(t,e){1&t&&(d.Wb(0,"div",9),d.Rb(1,"mat-spinner"),d.Vb())}function $(t,e){if(1&t&&(d.Rb(0,"employee-schedule-appointment",11),d.jc(1,"async")),2&t){var n=e.$implicit,i=d.ic(4);d.oc("appointment",n)("showEdit",d.kc(1,2,i.permissions$).change)}}function G(t,e){if(1&t&&(d.Ec(0,$,2,4,"employee-schedule-appointment",10),d.jc(1,"async")),2&t){var n=d.ic(3);d.oc("ngForOf",d.kc(1,1,n.appointments$))}}function N(t,e){if(1&t){var n=d.Xb();d.Wb(0,"employee-schedule-page-container",6),d.ec("updateCurrent",(function(t){return d.yc(n),d.ic(2).updateCurrent(t)}))("add",(function(t){d.yc(n);var i=e.ngIf;return d.ic(2).openCreateDialog(t,i)})),d.jc(1,"async"),d.jc(2,"async"),d.jc(3,"async"),d.jc(4,"async"),d.Ec(5,Y,2,0,"div",7),d.jc(6,"async"),d.Ec(7,G,2,3,"ng-template",null,8,d.Fc),d.Vb()}if(2&t){var i=e.ngIf,c=d.vc(8),o=d.ic(2);d.oc("currentDate",d.kc(1,7,o.currentDate$))("appointments",d.kc(2,9,o.appointments$))("permissions",d.kc(3,11,o.permissions$))("employee",i)("isMobile",d.kc(4,13,o.isMobile$)),d.Db(5),d.oc("ngIf",d.kc(6,15,o.isLoading$))("ngIfElse",c)}}function A(t,e){if(1&t&&(d.Ec(0,N,9,17,"employee-schedule-page-container",5),d.jc(1,"async")),2&t){var n=d.ic();d.oc("ngIf",d.kc(1,1,n.employee$))}}var H,F,X,T=[{path:"",icon:"",component:(F=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){return _classCallCheck(this,n),e.call(this,t)}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;this.initialize(),this.employee$=this.store.select(p.B),this.appointments$=this.employee$.pipe(Object(s.a)((function(e){return t.store.select(l.d.selectCurrentDateEmployeeAppointments,{employeeId:e.id})}))),this.permissions$=this.store.select(p.z,{model:a.a.modelType}),this.currentDate$=this.store.select(l.d.selectCurrentDate).pipe(Object(u.a)((function(t){return r.utc(t)}))),this.isLoading$=this.store.select(l.d.getIsLoadingEntities)}},{key:"initialize",value:function(){var t=r().utc().startOf("day");this.updateCurrent(t),this.loadAppointments(t)}},{key:"updateCurrent",value:function(t){this.store.dispatch(l.b.setCurrentDate({date:t})),this.loadAppointments(t)}},{key:"loadAppointments",value:function(t){var e={fromDate:r.utc(t).startOf("day"),toDate:r.utc(t).endOf("day")};this.store.dispatch(l.b.requestEntities({params:e}))}},{key:"openCreateDialog",value:function(t,e){this.store.dispatch(l.b.openCreateAppointmentDialog({date:t,employee:e,employeeMode:!0}))}}]),n}(f.a),F.\u0275fac=function(t){return new(t||F)(d.Qb(b.h))},F.\u0275cmp=d.Kb({type:F,selectors:[["employee-schedule-page"]],features:[d.Ab],decls:4,vars:4,consts:[["class","d-flex justify-content-center h-100",4,"ngIf","ngIfElse"],["schedule",""],[1,"d-flex","justify-content-center","h-100"],[1,"card-400","company-shadow-1","m-auto"],[4,"ngTemplateOutlet"],[3,"currentDate","appointments","permissions","employee","isMobile","updateCurrent","add",4,"ngIf"],[3,"currentDate","appointments","permissions","employee","isMobile","updateCurrent","add"],["class","d-flex justify-content-center",4,"ngIf","ngIfElse"],["appointments",""],[1,"d-flex","justify-content-center"],[3,"appointment","showEdit",4,"ngFor","ngForOf"],[3,"appointment","showEdit"]],template:function(t,e){if(1&t&&(d.Ec(0,S,3,1,"div",0),d.jc(1,"async"),d.Ec(2,A,2,3,"ng-template",null,1,d.Fc)),2&t){var n=d.vc(3);d.oc("ngIf",!d.kc(1,2,e.isMobile$))("ngIfElse",n)}},directives:[m.l,m.q,M,I.b,m.k,j],pipes:[m.b],styles:["[_nghost-%COMP%]{display:block;height:calc(100vh - 65px);min-height:calc(100vh - 65px)}.card-400[_ngcontent-%COMP%]{height:90%;border-radius:10px;padding:10px}"],changeDetection:0}),F),canActivate:[(H=function(){function t(e){_classCallCheck(this,t),this.store=e}return _createClass(t,[{key:"canActivate",value:function(t,e){return this.store.pipe(p.p,Object(u.a)((function(t){return!!t.employee})))}}]),t}(),H.\u0275fac=function(t){return new(t||H)(d.ac(b.h))},H.\u0275prov=d.Mb({token:H,factory:H.\u0275fac,providedIn:"root"}),H)]}],J=((X=function t(){_classCallCheck(this,t)}).\u0275mod=d.Ob({type:X}),X.\u0275inj=d.Nb({factory:function(t){return new(t||X)},imports:[[o.f.forChild(T)],o.f]}),X),z=n("QiP+");n.d(e,"EmployeeModule",(function(){return q}));var L,q=((L=function t(){_classCallCheck(this,t)}).\u0275mod=d.Ob({type:L}),L.\u0275inj=d.Nb({factory:function(t){return new(t||L)},imports:[[c.a,J,z.a]]}),L)}}]);